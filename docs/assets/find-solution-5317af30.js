var wr=Object.defineProperty;var vr=(m,y,v)=>y in m?wr(m,y,{enumerable:!0,configurable:!0,writable:!0,value:v}):m[y]=v;var rt=(m,y,v)=>(vr(m,typeof y!="symbol"?y+"":y,v),v);(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const m=Symbol("Comlink.proxy"),y=Symbol("Comlink.endpoint"),v=Symbol("Comlink.releaseProxy"),I=Symbol("Comlink.finalizer"),A=Symbol("Comlink.thrown"),N=t=>typeof t=="object"&&t!==null||typeof t=="function",et={canHandle:t=>N(t)&&t[m],serialize(t){const{port1:r,port2:e}=new MessageChannel;return L(t,r),[e,[e]]},deserialize(t){return t.start(),ut(t)}},nt={canHandle:t=>N(t)&&A in t,serialize({value:t}){let r;return t instanceof Error?r={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:r={isError:!1,value:t},[r,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},$=new Map([["proxy",et],["throw",nt]]);function at(t,r){for(const e of t)if(r===e||e==="*"||e instanceof RegExp&&e.test(r))return!0;return!1}function L(t,r=globalThis,e=["*"]){r.addEventListener("message",function n(a){if(!a||!a.data)return;if(!at(e,a.origin)){console.warn(`Invalid origin '${a.origin}' for comlink proxy`);return}const{id:i,type:u,path:s}=Object.assign({path:[]},a.data),l=(a.data.argumentList||[]).map(b);let c;try{const f=s.slice(0,-1).reduce((p,w)=>p[w],t),g=s.reduce((p,w)=>p[w],t);switch(u){case"GET":c=g;break;case"SET":f[s.slice(-1)[0]]=b(a.data.value),c=!0;break;case"APPLY":c=g.apply(f,l);break;case"CONSTRUCT":{const p=new g(...l);c=ft(p)}break;case"ENDPOINT":{const{port1:p,port2:w}=new MessageChannel;L(t,w),c=lt(p,[p])}break;case"RELEASE":c=void 0;break;default:return}}catch(f){c={value:f,[A]:0}}Promise.resolve(c).catch(f=>({value:f,[A]:0})).then(f=>{const[g,p]=O(f);r.postMessage(Object.assign(Object.assign({},g),{id:i}),p),u==="RELEASE"&&(r.removeEventListener("message",n),H(r),I in t&&typeof t[I]=="function"&&t[I]())}).catch(f=>{const[g,p]=O({value:new TypeError("Unserializable return value"),[A]:0});r.postMessage(Object.assign(Object.assign({},g),{id:i}),p)})}),r.start&&r.start()}function it(t){return t.constructor.name==="MessagePort"}function H(t){it(t)&&t.close()}function ut(t,r){return C(t,[],r)}function S(t){if(t)throw new Error("Proxy has been released and is not useable")}function W(t){return E(t,{type:"RELEASE"}).then(()=>{H(t)})}const R=new WeakMap,T="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const r=(R.get(t)||0)-1;R.set(t,r),r===0&&W(t)});function ot(t,r){const e=(R.get(r)||0)+1;R.set(r,e),T&&T.register(t,r,t)}function st(t){T&&T.unregister(t)}function C(t,r=[],e=function(){}){let n=!1;const a=new Proxy(e,{get(i,u){if(S(n),u===v)return()=>{st(a),W(t),n=!0};if(u==="then"){if(r.length===0)return{then:()=>a};const s=E(t,{type:"GET",path:r.map(l=>l.toString())}).then(b);return s.then.bind(s)}return C(t,[...r,u])},set(i,u,s){S(n);const[l,c]=O(s);return E(t,{type:"SET",path:[...r,u].map(f=>f.toString()),value:l},c).then(b)},apply(i,u,s){S(n);const l=r[r.length-1];if(l===y)return E(t,{type:"ENDPOINT"}).then(b);if(l==="bind")return C(t,r.slice(0,-1));const[c,f]=V(s);return E(t,{type:"APPLY",path:r.map(g=>g.toString()),argumentList:c},f).then(b)},construct(i,u){S(n);const[s,l]=V(u);return E(t,{type:"CONSTRUCT",path:r.map(c=>c.toString()),argumentList:s},l).then(b)}});return ot(a,t),a}function ct(t){return Array.prototype.concat.apply([],t)}function V(t){const r=t.map(O);return[r.map(e=>e[0]),ct(r.map(e=>e[1]))]}const F=new WeakMap;function lt(t,r){return F.set(t,r),t}function ft(t){return Object.assign(t,{[m]:!0})}function O(t){for(const[r,e]of $)if(e.canHandle(t)){const[n,a]=e.serialize(t);return[{type:"HANDLER",name:r,value:n},a]}return[{type:"RAW",value:t},F.get(t)||[]]}function b(t){switch(t.type){case"HANDLER":return $.get(t.name).deserialize(t.value);case"RAW":return t.value}}function E(t,r,e){return new Promise(n=>{const a=ht();t.addEventListener("message",function i(u){!u.data||!u.data.id||u.data.id!==a||(t.removeEventListener("message",i),n(u.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:a},r),e)})}function ht(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function o(t){return t!=null&&typeof t=="object"&&t["@@functional/placeholder"]===!0}function d(t){return function r(e){return arguments.length===0||o(e)?r:t.apply(this,arguments)}}function h(t){return function r(e,n){switch(arguments.length){case 0:return r;case 1:return o(e)?r:d(function(a){return t(e,a)});default:return o(e)&&o(n)?r:o(e)?d(function(a){return t(a,n)}):o(n)?d(function(a){return t(e,a)}):t(e,n)}}}function D(t,r){switch(t){case 0:return function(){return r.apply(this,arguments)};case 1:return function(e){return r.apply(this,arguments)};case 2:return function(e,n){return r.apply(this,arguments)};case 3:return function(e,n,a){return r.apply(this,arguments)};case 4:return function(e,n,a,i){return r.apply(this,arguments)};case 5:return function(e,n,a,i,u){return r.apply(this,arguments)};case 6:return function(e,n,a,i,u,s){return r.apply(this,arguments)};case 7:return function(e,n,a,i,u,s,l){return r.apply(this,arguments)};case 8:return function(e,n,a,i,u,s,l,c){return r.apply(this,arguments)};case 9:return function(e,n,a,i,u,s,l,c,f){return r.apply(this,arguments)};case 10:return function(e,n,a,i,u,s,l,c,f,g){return r.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function M(t){return function r(e,n,a){switch(arguments.length){case 0:return r;case 1:return o(e)?r:h(function(i,u){return t(e,i,u)});case 2:return o(e)&&o(n)?r:o(e)?h(function(i,u){return t(i,n,u)}):o(n)?h(function(i,u){return t(e,i,u)}):d(function(i){return t(e,n,i)});default:return o(e)&&o(n)&&o(a)?r:o(e)&&o(n)?h(function(i,u){return t(i,u,a)}):o(e)&&o(a)?h(function(i,u){return t(i,n,u)}):o(n)&&o(a)?h(function(i,u){return t(e,i,u)}):o(e)?d(function(i){return t(i,n,a)}):o(n)?d(function(i){return t(e,i,a)}):o(a)?d(function(i){return t(e,n,i)}):t(e,n,a)}}}var k=Array.isArray||function(r){return r!=null&&r.length>=0&&Object.prototype.toString.call(r)==="[object Array]"};function gt(t){return t!=null&&typeof t["@@transducer/step"]=="function"}function pt(t,r,e){return function(){if(arguments.length===0)return e();var n=arguments[arguments.length-1];if(!k(n)){for(var a=0;a<t.length;){if(typeof n[t[a]]=="function")return n[t[a]].apply(n,Array.prototype.slice.call(arguments,0,-1));a+=1}if(gt(n)){var i=r.apply(null,Array.prototype.slice.call(arguments,0,-1));return i(n)}}return e.apply(this,arguments)}}var B={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}};function yt(t,r){return Object.prototype.hasOwnProperty.call(r,t)}function dt(t){return Object.prototype.toString.call(t)==="[object Object]"}var mt=Number.isInteger||function(r){return r<<0===r};function X(t){return Object.prototype.toString.call(t)==="[object String]"}var wt=h(function(r,e){var n=r<0?e.length+r:r;return X(e)?e.charAt(n):e[n]}),U=wt,vt=h(function(r,e){if(e!=null)return mt(r)?U(r,e):e[r]}),G=vt,bt=d(function(r){return k(r)?!0:!r||typeof r!="object"||X(r)?!1:r.length===0?!0:r.length>0?r.hasOwnProperty(0)&&r.hasOwnProperty(r.length-1):!1}),Et=bt,Y=typeof Symbol<"u"?Symbol.iterator:"@@iterator";function _t(t,r,e){return function(a,i,u){if(Et(u))return t(a,i,u);if(u==null)return i;if(typeof u["fantasy-land/reduce"]=="function")return r(a,i,u,"fantasy-land/reduce");if(u[Y]!=null)return e(a,i,u[Y]());if(typeof u.next=="function")return e(a,i,u);if(typeof u.reduce=="function")return r(a,i,u,"reduce");throw new TypeError("reduce: list must be array or iterable")}}function At(t,r,e){for(var n=0,a=e.length;n<a;){if(r=t["@@transducer/step"](r,e[n]),r&&r["@@transducer/reduced"]){r=r["@@transducer/value"];break}n+=1}return t["@@transducer/result"](r)}var St=h(function(r,e){return D(r.length,function(){return r.apply(e,arguments)})}),Rt=St;function Tt(t,r,e){for(var n=e.next();!n.done;){if(r=t["@@transducer/step"](r,n.value),r&&r["@@transducer/reduced"]){r=r["@@transducer/value"];break}n=e.next()}return t["@@transducer/result"](r)}function Ot(t,r,e,n){return t["@@transducer/result"](e[n](Rt(t["@@transducer/step"],t),r))}var kt=_t(At,Ot,Tt),Pt=kt,xt=function(){function t(r){this.f=r}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(r){return r},t.prototype["@@transducer/step"]=function(r,e){return this.f(r,e)},t}();function It(t){return new xt(t)}var Lt=M(function(t,r,e){return Pt(typeof t=="function"?It(t):t,r,e)}),Ct=Lt;function Mt(t,r){return function(){return r.call(this,t.apply(this,arguments))}}function q(t,r){return function(){var e=arguments.length;if(e===0)return r();var n=arguments[e-1];return k(n)||typeof n[t]!="function"?r.apply(this,arguments):n[t].apply(n,Array.prototype.slice.call(arguments,0,e-1))}}var zt=M(q("slice",function(r,e,n){return Array.prototype.slice.call(n,r,e)})),J=zt,jt=d(q("tail",J(1,1/0))),Nt=jt;function Q(){if(arguments.length===0)throw new Error("pipe requires at least one argument");return D(arguments[0].length,Ct(Mt,arguments[0],Nt(arguments)))}var $t=function(){function t(r,e){this.xf=e,this.n=r}return t.prototype["@@transducer/init"]=B.init,t.prototype["@@transducer/result"]=B.result,t.prototype["@@transducer/step"]=function(r,e){return this.n>0?(this.n-=1,r):this.xf["@@transducer/step"](r,e)},t}();function Ht(t){return function(r){return new $t(t,r)}}var Wt=h(pt(["drop"],Ht,function(r,e){return J(Math.max(0,r),1/0,e)})),Vt=Wt,Ft=U(-1),Dt=Ft,Bt=h(function(r,e){return Vt(r>=0?e.length-r:0,e)}),Xt=Bt,Ut=h(function t(r,e){if(!dt(e)&&!k(e))return e;var n=e instanceof Array?[]:{},a,i,u;for(i in e)a=r[i],u=typeof a,n[i]=u==="function"?a(e[i]):a&&u==="object"?t(a,e[i]):e[i];return n}),Gt=Ut;function Yt(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),e=1,n=arguments.length;e<n;){var a=arguments[e];if(a!=null)for(var i in a)yt(i,a)&&(r[i]=a[i]);e+=1}return r}var qt=typeof Object.assign=="function"?Object.assign:Yt;function Z(t){return Object.prototype.toString.call(t)==="[object Number]"}var Jt=h(function(r,e){return qt({},e,r)}),Qt=Jt,Zt=h(function(r,e){if(!(Z(r)&&Z(e)))throw new TypeError("Both arguments to range must be numbers");for(var n=[],a=r;a<e;)n.push(a),a+=1;return n}),Kt=Zt,tr=h(function(r,e){return Array.prototype.slice.call(e,0).sort(function(n,a){var i=r(n),u=r(a);return i<u?-1:i>u?1:0})}),z=tr,rr=M(function(r,e,n){return r(n)?e(n):n}),er=rr;const K=18;Kt(1,K).map(t=>`./images/${t}.jpg`);const nr=400,ar=11,ir=.9,ur=!1,or=({pictures:t,sizeHomogeneity:r,score:e})=>t.length<=4?e:e*r,sr=t=>t.length>0,cr=(t,r)=>{const e=Q(z(or),er(()=>t.preferAspectRatio,Q(Xt((K-r[0].pictures.length)*5),z(G("score")))))(r);return Gt({pictures:z(G("url"))},Dt(e))},lr=t=>"url"in t,_=(t,r,e)=>{if(lr(e))return[{position:t,dimension:r,url:e.url}];if(e.horizontal){const n=r.height*e.first.aspectRatio;return[..._(t,{width:n,height:r.height},e.first),..._({x:t.x+n,y:t.y},{width:r.width-n,height:r.height},e.second)]}else{const n=r.width/e.first.aspectRatio;return[..._(t,{width:r.width,height:n},e.first),..._({x:t.x,y:t.y+n},{width:r.width,height:r.height-n},e.second)]}},fr=t=>{let r=0,e=0,n=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;return t.forEach(i=>{i.width>r&&(r=i.width),i.height>e&&(e=i.height),i.width<n&&(n=i.width),i.height<a&&(a=i.height)}),r===0||e===0?0:(n/r+a/e)/2},hr=(t,r,e)=>{const n=_({x:0,y:0},t,e),a=fr(n.map(i=>i.dimension));return{dimension:t,score:r,sizeHomogeneity:a,pictures:n}};class P{constructor(r,e,n){rt(this,"aspectRatio",0);this.horizontal=r,this.first=e,this.second=n;const a=e.aspectRatio+n.aspectRatio;this.aspectRatio=r?a:e.aspectRatio*n.aspectRatio/a}}const x=(t,r)=>t+Math.random()*(r-t+1)|0;function*j(t){if(t.length===1)yield t[0];else for(let r=1;r<t.length;r++){const e=j(t.slice(0,r)),n=j(t.slice(r));for(const a of e)for(const i of n)yield new P(!0,a,i),yield new P(!1,a,i)}}const tt=t=>{const r=t.length-1;if(r===0)return t[0];if(r===1)return new P(x(0,1)===0,t[0],t[1]);const e=x(0,r);let n;do n=x(0,r);while(e===n);const a=new P(x(0,1)===0,t[e],t[n]);return tt(t.with(e,a).toSpliced(n,1))};function*gr(t){for(;;)yield tt(t)}const pr=(t,r)=>{const e=t.height*r;if(e<=t.width)return{width:e,height:t.height};{const n=t.width/r;return{width:t.width,height:n}}},yr={maxComputationTime:nr,randomizeThreshold:ar,preferAspectRatio:ur};var dr=Object.freeze({__proto__:null,findSolution:(t,r,e)=>{const n=Qt(e??{},yr),a=Date.now(),i=r.width/r.height,u=[],s=t.length<n.randomizeThreshold,l=s?j(t):gr(t),{abs:c}=Math,{now:f}=Date;for(const g of l){const w=1/(1+c(g.aspectRatio-i));if(!s&&w<ir)continue;const mr=pr(r,g.aspectRatio);if(u.push(hr(mr,w,g)),f()-a>n.maxComputationTime)break}if(console.debug("solutions found: ",u.length),!sr(u))throw new Error("No solution");return cr(n,u)}});L(dr)})();
