var _e=Object.defineProperty;var Te=(p,y,m)=>y in p?_e(p,y,{enumerable:!0,configurable:!0,writable:!0,value:m}):p[y]=m;var ht=(p,y,m)=>(Te(p,typeof y!="symbol"?y+"":y,m),m);(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p=Symbol("Comlink.proxy"),y=Symbol("Comlink.endpoint"),m=Symbol("Comlink.releaseProxy"),P=Symbol("Comlink.finalizer"),_=Symbol("Comlink.thrown"),V=t=>typeof t=="object"&&t!==null||typeof t=="function",yt={canHandle:t=>V(t)&&t[p],serialize(t){const{port1:e,port2:n}=new MessageChannel;return k(t,e),[n,[n]]},deserialize(t){return t.start(),vt(t)}},pt={canHandle:t=>V(t)&&_ in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},W=new Map([["proxy",yt],["throw",pt]]);function mt(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function k(t,e=globalThis,n=["*"]){e.addEventListener("message",function r(o){if(!o||!o.data)return;if(!mt(n,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}const{id:a,type:i,path:s}=Object.assign({path:[]},o.data),u=(o.data.argumentList||[]).map(d);let c;try{const l=s.slice(0,-1).reduce((f,j)=>f[j],t),g=s.reduce((f,j)=>f[j],t);switch(i){case"GET":c=g;break;case"SET":l[s.slice(-1)[0]]=d(o.data.value),c=!0;break;case"APPLY":c=g.apply(l,u);break;case"CONSTRUCT":{const f=new g(...u);c=bt(f)}break;case"ENDPOINT":{const{port1:f,port2:j}=new MessageChannel;k(t,j),c=At(f,[f])}break;case"RELEASE":c=void 0;break;default:return}}catch(l){c={value:l,[_]:0}}Promise.resolve(c).catch(l=>({value:l,[_]:0})).then(l=>{const[g,f]=R(l);e.postMessage(Object.assign(Object.assign({},g),{id:a}),f),i==="RELEASE"&&(e.removeEventListener("message",r),B(e),P in t&&typeof t[P]=="function"&&t[P]())}).catch(l=>{const[g,f]=R({value:new TypeError("Unserializable return value"),[_]:0});e.postMessage(Object.assign(Object.assign({},g),{id:a}),f)})}),e.start&&e.start()}function dt(t){return t.constructor.name==="MessagePort"}function B(t){dt(t)&&t.close()}function vt(t,e){return I(t,[],e)}function T(t){if(t)throw new Error("Proxy has been released and is not useable")}function G(t){return w(t,{type:"RELEASE"}).then(()=>{B(t)})}const C=new WeakMap,z="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(C.get(t)||0)-1;C.set(t,e),e===0&&G(t)});function wt(t,e){const n=(C.get(e)||0)+1;C.set(e,n),z&&z.register(t,e,t)}function St(t){z&&z.unregister(t)}function I(t,e=[],n=function(){}){let r=!1;const o=new Proxy(n,{get(a,i){if(T(r),i===m)return()=>{St(o),G(t),r=!0};if(i==="then"){if(e.length===0)return{then:()=>o};const s=w(t,{type:"GET",path:e.map(u=>u.toString())}).then(d);return s.then.bind(s)}return I(t,[...e,i])},set(a,i,s){T(r);const[u,c]=R(s);return w(t,{type:"SET",path:[...e,i].map(l=>l.toString()),value:u},c).then(d)},apply(a,i,s){T(r);const u=e[e.length-1];if(u===y)return w(t,{type:"ENDPOINT"}).then(d);if(u==="bind")return I(t,e.slice(0,-1));const[c,l]=X(s);return w(t,{type:"APPLY",path:e.map(g=>g.toString()),argumentList:c},l).then(d)},construct(a,i){T(r);const[s,u]=X(i);return w(t,{type:"CONSTRUCT",path:e.map(c=>c.toString()),argumentList:s},u).then(d)}});return wt(o,t),o}function Ot(t){return Array.prototype.concat.apply([],t)}function X(t){const e=t.map(R);return[e.map(n=>n[0]),Ot(e.map(n=>n[1]))]}const Y=new WeakMap;function At(t,e){return Y.set(t,e),t}function bt(t){return Object.assign(t,{[p]:!0})}function R(t){for(const[e,n]of W)if(n.canHandle(t)){const[r,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},o]}return[{type:"RAW",value:t},Y.get(t)||[]]}function d(t){switch(t.type){case"HANDLER":return W.get(t.name).deserialize(t.value);case"RAW":return t.value}}function w(t,e,n){return new Promise(r=>{const o=Et();t.addEventListener("message",function a(i){!i.data||!i.data.id||i.data.id!==o||(t.removeEventListener("message",a),r(i.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),n)})}function Et(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function S(t){return t!=null&&typeof t=="object"&&t["@@functional/placeholder"]===!0}function v(t){return function e(n){return arguments.length===0||S(n)?e:t.apply(this,arguments)}}function h(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return S(n)?e:v(function(o){return t(n,o)});default:return S(n)&&S(r)?e:S(n)?v(function(o){return t(o,r)}):S(r)?v(function(o){return t(n,o)}):t(n,r)}}}var M=Array.isArray||function(e){return e!=null&&e.length>=0&&Object.prototype.toString.call(e)==="[object Array]"};function jt(t){return t!=null&&typeof t["@@transducer/step"]=="function"}function _t(t,e,n){return function(){if(arguments.length===0)return n();var r=arguments[arguments.length-1];if(!M(r)){for(var o=0;o<t.length;){if(typeof r[t[o]]=="function")return r[t[o]].apply(r,Array.prototype.slice.call(arguments,0,-1));o+=1}if(jt(r)){var a=e.apply(null,Array.prototype.slice.call(arguments,0,-1));return a(r)}}return n.apply(this,arguments)}}var Z={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}};function J(t){for(var e=[],n;!(n=t.next()).done;)e.push(n.value);return e}function Q(t,e,n){for(var r=0,o=n.length;r<o;){if(t(e,n[r]))return!0;r+=1}return!1}function Tt(t){var e=String(t).match(/^function (\w*)/);return e==null?"":e[1]}function O(t,e){return Object.prototype.hasOwnProperty.call(e,t)}function Ct(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}var N=typeof Object.is=="function"?Object.is:Ct,K=Object.prototype.toString,zt=function(){return K.call(arguments)==="[object Arguments]"?function(e){return K.call(e)==="[object Arguments]"}:function(e){return O("callee",e)}}(),Rt=zt,Mt=!{toString:null}.propertyIsEnumerable("toString"),tt=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],et=function(){return arguments.propertyIsEnumerable("length")}(),Pt=function(e,n){for(var r=0;r<e.length;){if(e[r]===n)return!0;r+=1}return!1},kt=v(typeof Object.keys=="function"&&!et?function(e){return Object(e)!==e?[]:Object.keys(e)}:function(e){if(Object(e)!==e)return[];var n,r,o=[],a=et&&Rt(e);for(n in e)O(n,e)&&(!a||n!=="length")&&(o[o.length]=n);if(Mt)for(r=tt.length-1;r>=0;)n=tt[r],O(n,e)&&!Pt(o,n)&&(o[o.length]=n),r-=1;return o}),A=kt,It=v(function(e){return e===null?"Null":e===void 0?"Undefined":Object.prototype.toString.call(e).slice(8,-1)}),nt=It;function rt(t,e,n,r){var o=J(t),a=J(e);function i(s,u){return H(s,u,n.slice(),r.slice())}return!Q(function(s,u){return!Q(i,u,s)},a,o)}function H(t,e,n,r){if(N(t,e))return!0;var o=nt(t);if(o!==nt(e))return!1;if(typeof t["fantasy-land/equals"]=="function"||typeof e["fantasy-land/equals"]=="function")return typeof t["fantasy-land/equals"]=="function"&&t["fantasy-land/equals"](e)&&typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](t);if(typeof t.equals=="function"||typeof e.equals=="function")return typeof t.equals=="function"&&t.equals(e)&&typeof e.equals=="function"&&e.equals(t);switch(o){case"Arguments":case"Array":case"Object":if(typeof t.constructor=="function"&&Tt(t.constructor)==="Promise")return t===e;break;case"Boolean":case"Number":case"String":if(!(typeof t==typeof e&&N(t.valueOf(),e.valueOf())))return!1;break;case"Date":if(!N(t.valueOf(),e.valueOf()))return!1;break;case"Error":return t.name===e.name&&t.message===e.message;case"RegExp":if(!(t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.sticky===e.sticky&&t.unicode===e.unicode))return!1;break}for(var a=n.length-1;a>=0;){if(n[a]===t)return r[a]===e;a-=1}switch(o){case"Map":return t.size!==e.size?!1:rt(t.entries(),e.entries(),n.concat([t]),r.concat([e]));case"Set":return t.size!==e.size?!1:rt(t.values(),e.values(),n.concat([t]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var i=A(t);if(i.length!==A(e).length)return!1;var s=n.concat([t]),u=r.concat([e]);for(a=i.length-1;a>=0;){var c=i[a];if(!(O(c,e)&&H(e[c],t[c],s,u)))return!1;a-=1}return!0}var Nt=h(function(e,n){return H(e,n,[],[])}),Ht=Nt;function $t(t,e,n){var r,o;if(typeof t.indexOf=="function")switch(typeof e){case"number":if(e===0){for(r=1/e;n<t.length;){if(o=t[n],o===0&&1/o===r)return n;n+=1}return-1}else if(e!==e){for(;n<t.length;){if(o=t[n],typeof o=="number"&&o!==o)return n;n+=1}return-1}return t.indexOf(e,n);case"string":case"boolean":case"function":case"undefined":return t.indexOf(e,n);case"object":if(e===null)return t.indexOf(e,n)}for(;n<t.length;){if(Ht(t[n],e))return n;n+=1}return-1}function qt(t,e){return $t(e,t,0)>=0}function $(t,e){for(var n=0,r=e.length,o=Array(r);n<r;)o[n]=t(e[n]),n+=1;return o}function q(t){var e=t.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0");return'"'+e.replace(/"/g,'\\"')+'"'}var b=function(e){return(e<10?"0":"")+e},xt=typeof Date.prototype.toISOString=="function"?function(e){return e.toISOString()}:function(e){return e.getUTCFullYear()+"-"+b(e.getUTCMonth()+1)+"-"+b(e.getUTCDate())+"T"+b(e.getUTCHours())+":"+b(e.getUTCMinutes())+":"+b(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},Lt=xt;function Ut(t){return function(){return!t.apply(this,arguments)}}function Ft(t,e,n){for(var r=0,o=n.length;r<o;)e=t(e,n[r]),r+=1;return e}function Dt(t,e){for(var n=0,r=e.length,o=[];n<r;)t(e[n])&&(o[o.length]=e[n]),n+=1;return o}function ot(t){return Object.prototype.toString.call(t)==="[object Object]"}var Vt=function(){function t(e,n){this.xf=n,this.f=e}return t.prototype["@@transducer/init"]=Z.init,t.prototype["@@transducer/result"]=Z.result,t.prototype["@@transducer/step"]=function(e,n){return this.f(n)?this.xf["@@transducer/step"](e,n):e},t}();function Wt(t){return function(e){return new Vt(t,e)}}var Bt=h(_t(["fantasy-land/filter","filter"],Wt,function(t,e){return ot(e)?Ft(function(n,r){return t(e[r])&&(n[r]=e[r]),n},{},A(e)):Dt(t,e)})),Gt=Bt,Xt=h(function(e,n){return Gt(Ut(e),n)}),Yt=Xt;function at(t,e){var n=function(i){var s=e.concat([t]);return qt(i,s)?"<Circular>":at(i,s)},r=function(a,i){return $(function(s){return q(s)+": "+n(a[s])},i.slice().sort())};switch(Object.prototype.toString.call(t)){case"[object Arguments]":return"(function() { return arguments; }("+$(n,t).join(", ")+"))";case"[object Array]":return"["+$(n,t).concat(r(t,Yt(function(a){return/^\d+$/.test(a)},A(t)))).join(", ")+"]";case"[object Boolean]":return typeof t=="object"?"new Boolean("+n(t.valueOf())+")":t.toString();case"[object Date]":return"new Date("+(isNaN(t.valueOf())?n(NaN):q(Lt(t)))+")";case"[object Map]":return"new Map("+n(Array.from(t))+")";case"[object Null]":return"null";case"[object Number]":return typeof t=="object"?"new Number("+n(t.valueOf())+")":1/t===-1/0?"-0":t.toString(10);case"[object Set]":return"new Set("+n(Array.from(t).sort())+")";case"[object String]":return typeof t=="object"?"new String("+n(t.valueOf())+")":q(t);case"[object Undefined]":return"undefined";default:if(typeof t.toString=="function"){var o=t.toString();if(o!=="[object Object]")return o}return"{"+r(t,A(t)).join(", ")+"}"}}var Zt=v(function(e){return at(e,[])}),x=Zt,Jt=Number.isInteger||function(e){return e<<0===e};function L(t){return Object.prototype.toString.call(t)==="[object String]"}var Qt=h(function(e,n){var r=e<0?n.length+e:e;return L(n)?n.charAt(r):n[r]}),it=Qt,Kt=h(function(e,n){if(n!=null)return Jt(e)?it(e,n):n[e]}),te=Kt;function st(t){var e=Object.prototype.toString.call(t);return e==="[object Function]"||e==="[object AsyncFunction]"||e==="[object GeneratorFunction]"||e==="[object AsyncGeneratorFunction]"}var ee=h(function(e,n){if(M(e)){if(M(n))return e.concat(n);throw new TypeError(x(n)+" is not an array")}if(L(e)){if(L(n))return e+n;throw new TypeError(x(n)+" is not a string")}if(e!=null&&st(e["fantasy-land/concat"]))return e["fantasy-land/concat"](n);if(e!=null&&st(e.concat))return e.concat(n);throw new TypeError(x(e)+' does not have a method named "concat" or "fantasy-land/concat"')}),ut=ee,ne=it(-1),re=ne,oe=h(function t(e,n){if(!ot(n)&&!M(n))return n;var r=n instanceof Array?[]:{},o,a,i;for(a in n)o=e[a],i=typeof o,r[a]=i==="function"?o(n[a]):o&&i==="object"?t(o,n[a]):n[a];return r}),ae=oe;function ie(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1,r=arguments.length;n<r;){var o=arguments[n];if(o!=null)for(var a in o)O(a,o)&&(e[a]=o[a]);n+=1}return e}var se=typeof Object.assign=="function"?Object.assign:ie;function ct(t){return Object.prototype.toString.call(t)==="[object Number]"}var ue=h(function(e,n){return se({},n,e)}),ce=ue,le=h(function(e,n){if(!(ct(e)&&ct(n)))throw new TypeError("Both arguments to range must be numbers");for(var r=[],o=e;o<n;)r.push(o),o+=1;return r}),fe=le,ge=h(function(e,n){return Array.prototype.slice.call(n,0).sort(function(r,o){var a=e(r),i=e(o);return a<i?-1:a>i?1:0})}),lt=ge;fe(1,18).map(t=>`./images/${t}.jpg`);const he=400,ye=.5,pe=8,me=t=>t.length>0,de=t=>e=>(e.score+e.sizeHomogeneity*t.sizeHomogeneity)/(t.sizeHomogeneity+1),ve=(t,e)=>{const n=lt(de(e),t),r=re(n);return ae({pictures:lt(te("url"))},r)},we=t=>"url"in t,E=(t,e,n)=>{if(we(n))return[{position:t,dimension:e,url:n.url}];if(n.horizontal){const r=e.height*n.first.aspectRatio,o={x:t.x+r,y:t.y},a={width:r,height:e.height},s={width:e.width-r,height:e.height};return ut(E(t,a,n.first),E(o,s,n.second))}else{const r=e.width/n.first.aspectRatio,o={x:t.x,y:t.y+r},a={width:e.width,height:r},i=e.height-r,s={width:e.width,height:i};return ut(E(t,a,n.first),E(o,s,n.second))}},Se=t=>{const e=Math.max(...t.map(a=>a.width)),n=Math.max(...t.map(a=>a.height)),r=Math.min(...t.map(a=>a.width)),o=Math.min(...t.map(a=>a.height));return(r/e+o/n)/2},Oe=(t,e,n)=>{const r=E({x:0,y:0},t,n),o=Se(r.map(a=>a.dimension));return{dimension:t,score:e,sizeHomogeneity:o,pictures:r}};class U{constructor(e,n,r){ht(this,"aspectRatio",0);this.horizontal=e,this.first=n,this.second=r;const o=n.aspectRatio+r.aspectRatio;this.aspectRatio=e?o:n.aspectRatio*r.aspectRatio/o}}const F=(t,e)=>t+Math.random()*(e-t+1)|0;function*D(t){if(t.length===1)yield t[0];else for(let e=1;e<t.length;e++){const n=D(t.slice(0,e)),r=D(t.slice(e));for(const o of n)for(const a of r)yield new U(!0,o,a),yield new U(!1,o,a)}}const ft=(t,e)=>new U(!!F(0,1),t,e),gt=t=>{const e=t.length-1;if(e===0)return t[0];if(e===1)return ft(t[0],t[1]);const n=F(0,e);let r;do r=F(0,e);while(n===r);const o=ft(t[n],t[r]);return gt(t.with(n,o).toSpliced(r,1))};function*Ae(t){for(;;)yield gt(t)}const be=(t,e)=>{const n=t.height*e;if(n<=t.width)return{width:n,height:t.height};{const r=t.width/e;return{width:t.width,height:r}}},Ee={maxComputationTime:he,sizeHomogeneity:ye,randomizeThreshold:pe};var je=Object.freeze({__proto__:null,findSolution:(t,e,n)=>{const r=ce(n??{},Ee),o=Date.now(),a=e.width/e.height,i=[];console.log(t.length<r.randomizeThreshold?"all":"random");const s=t.length<r.randomizeThreshold?D(t):Ae(t);for(const u of s){const c=Math.abs(u.aspectRatio-a),l=Math.max(0,1-c/a),g=be(e,u.aspectRatio);if(i.push(Oe(g,l,u)),Date.now()-o>r.maxComputationTime){console.log("computation took too long, aborting");break}}if(console.log("solutions",i.length),!me(i))throw new Error("No solution");return ve(i,r)}});k(je)})();
